"use strict";const e=[];function i(e){var i=(e=Math.floor(255*e)).toString(16);return 1==i.length?"0"+i:i}figma.ui.onmessage=i=>{for(let n of e)i.action===n.action&&n.callback(i.data)},console.clear();var n,t,a,r=[{size:16,group:"General"},{size:24,group:"General"},{size:32,group:"General"},{size:48,group:"General"},{size:64,group:"General"},{size:96,group:"General"},{size:128,group:"General"},{size:20,group:"iOS",label:"Notification"},{size:29,group:"iOS",label:"Settings"},{size:40,group:"iOS",label:"Spotlight"},{size:60,group:"iOS",label:"iPhone"},{size:76,group:"iOS",label:"iPad"},{size:83.5,group:"iOS",label:"iPad Pro"},{size:16,group:"Android",label:"Small Contextual"},{size:22,group:"Android",label:"Notification"},{size:24,group:"Android",label:"System"},{size:48,group:"Android",label:"Product"}];function g(e){return"FRAME"===e.type||"GROUP"===e.type||"COMPONENT"===e.type||"INSTANCE"===e.type}function o(e){return e.height<=256&&e.width<=256}async function s(e,i,n){var t=await e.exportAsync({format:"SVG"});return t=String.fromCharCode.apply(null,t)}async function c(e,i){if(e){(n={thumbnail:{},thumbnails:[],name:""}).currentIconThumbnail=await s(e,e.width);for(let e=0;e<r.length;e++)n.thumbnails.push({}),n.thumbnails[e].size=r[e].size,n.thumbnails[e].group=r[e].group,n.thumbnails[e].label=r[e].label;return n.name=e.name,n}}async function l(e){if(e)return await s(e,e.width)}function u(){var e=function(e){if(e){let{r:n,g:t,b:a}=e;return"#"+i(n)+i(t)+i(a)}}(figma.currentPage.backgrounds[0].color);return"#e5e5e5"!==e?e:"#ffffff"}function f(e){if(e.width===e.height)return e}function m(e){if(e&&f(e)&&o(e)&&g(e))return e}function h(e,i){return i.findOne((i=>i.id===e.id))}var d={width:528,height:352};a=figma.currentPage.selection[0],figma.clientStorage.getAsync("uiSize").then((e=>{var i,n;e||(i="uiSize",n=d,figma.clientStorage.setAsync(i,n),e=d),1===figma.currentPage.selection.length?o(figma.currentPage.selection[0])?g(figma.currentPage.selection[0])?f(figma.currentPage.selection[0])?(figma.showUI(__html__,e),t=figma.currentPage.selection[0],l(figma.currentPage.selection[0]).then((e=>{c(t).then((i=>{var n;figma.currentPage.selection[0].id!==t.id&&(n=e),figma.ui.postMessage(Object.assign(Object.assign({},i),{selectedIconThumbnail:n,canvasColor:u()}))}))}))):figma.closePlugin("Selection must be square"):figma.closePlugin("Selection must be a frame, group, component or instance"):figma.closePlugin("Icon must be 256px or smaller"):0===figma.currentPage.selection.length?figma.closePlugin("Select an icon"):figma.closePlugin("Select one icon at a time")})),figma.ui.onmessage=e=>{"set-preview"===e.type&&(t=a||figma.currentPage.selection[0],l(a).then((e=>{c(t).then((i=>{figma.ui.postMessage(Object.assign(Object.assign({},i),{selectedIconThumbnail:e}))}))}))),"resize"===e.type&&(figma.ui.resize(e.size.width,e.size.height),figma.clientStorage.setAsync("uiSize",e.size).catch((e=>{})))},figma.on("selectionchange",(()=>{1===figma.currentPage.selection.length?h(figma.currentPage.selection[0],t)?figma.ui.postMessage({selectedIconThumbnail:void 0}):(figma.currentPage.selection[0].width===figma.currentPage.selection[0].height&&(a=figma.currentPage.selection[0]),figma.currentPage.selection[0].width===figma.currentPage.selection[0].height&&1===figma.currentPage.selection.length&&m(figma.currentPage.selection[0])&&l(a).then((e=>{var i;i=figma.currentPage.selection[0].id!==t.id?e:void 0,figma.ui.postMessage({selectedIconThumbnail:i})}))):figma.ui.postMessage({selectedIconThumbnail:void 0})})),setInterval((()=>{a&&l(a).then((e=>{var i;m(figma.currentPage.selection[0])&&figma.currentPage.selection.length>0&&(h(figma.currentPage.selection[0],t)?i=void 0:figma.currentPage.selection[0].id!==t.id&&(i=e)),c(t).then((e=>{figma.ui.postMessage(Object.assign(Object.assign({},e),{selectedIconThumbnail:i,canvasColor:u()}))}))}))}),300);
