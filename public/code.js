"use strict";function e(e,i){return figma.clientStorage.setAsync(e,i)}const i=[];function t(e){var i=(e=Math.floor(255*e)).toString(16);return 1==i.length?"0"+i:i}figma.ui.onmessage=e=>{for(let t of i)e.action===t.action&&t.callback(e.data)},console.clear();var n,a,o,r=[{size:16,group:"General"},{size:24,group:"General"},{size:32,group:"General"},{size:48,group:"General"},{size:64,group:"General"},{size:96,group:"General"},{size:128,group:"General"},{size:20,group:"iOS",label:"Notification"},{size:29,group:"iOS",label:"Settings"},{size:40,group:"iOS",label:"Spotlight"},{size:60,group:"iOS",label:"iPhone"},{size:76,group:"iOS",label:"iPad"},{size:83.5,group:"iOS",label:"iPad Pro"},{size:16,group:"Android",label:"Small Contextual"},{size:22,group:"Android",label:"Notification"},{size:24,group:"Android",label:"System"},{size:48,group:"Android",label:"Product"}];function s(e){return"FRAME"===e.type||"GROUP"===e.type||"COMPONENT"===e.type||"INSTANCE"===e.type}function l(e){return e.height<=512&&e.width<=512}async function c(e,i,t){return await e.exportAsync({format:"SVG"})}async function g(e,i){if(e){(n={thumbnail:{},thumbnails:[],name:""}).currentIconThumbnail=await c(e,e.width);for(let e=0;e<r.length;e++)n.thumbnails.push({}),n.thumbnails[e].size=r[e].size,n.thumbnails[e].group=r[e].group,n.thumbnails[e].label=r[e].label;return n.name=e.name,n}}async function u(e){if(e)return await c(e,e.width)}function f(){var e=function(e){if(e){let{r:i,g:n,b:a}=e;return"#"+t(i)+t(n)+t(a)}}(figma.currentPage.backgrounds[0].color);return"#e5e5e5"!==e?e:"#ffffff"}function m(e){if(e.width===e.height)return e}function h(e){if(e&&m(e)&&l(e)&&s(e))return e}var p,d={width:528,height:352},b={top:0,left:0};o=figma.currentPage.selection[0],figma.clientStorage.getAsync("uiSize").then((i=>{i||(e("uiSize",d),i=d),figma.clientStorage.getAsync("scrollPos").then((t=>{var n,r,c,d;t||(e("scrollPos",b),t=b),console.log(i),1===figma.currentPage.selection.length?l(figma.currentPage.selection[0])?s(figma.currentPage.selection[0])?m(figma.currentPage.selection[0])?(figma.showUI(__html__,i),a=figma.currentPage.selection[0],u(figma.currentPage.selection[0]).then((e=>{g(a).then((i=>{var n;figma.currentPage.selection[0].id!==a.id&&(n=e),figma.ui.postMessage(Object.assign(Object.assign({},i),{selectedIconThumbnail:n,canvasColor:f(),scrollPos:t}))}))}))):figma.closePlugin("Selection must be square"):figma.closePlugin("Selection must be a frame, group, component or instance"):figma.closePlugin("Icon must be 256px or smaller"):0===figma.currentPage.selection.length?figma.closePlugin("Select an icon"):figma.closePlugin("Select one icon at a time"),figma.on("selectionchange",(()=>{1===figma.currentPage.selection.length&&!function(e,i){if(i&&e)return i.findOne((i=>i.id===e.id))}(figma.currentPage.selection[0],a)?h(figma.currentPage.selection[0])?(o=figma.currentPage.selection[0],1===figma.currentPage.selection.length&&h(figma.currentPage.selection[0])&&u(o).then((e=>{var i;figma.currentPage.selection[0].id!==a.id?(i=e,p=e):(i=void 0,p=void 0),figma.ui.postMessage({selectedIconThumbnail:i})}))):p=void 0:(p=void 0,figma.ui.postMessage({selectedIconThumbnail:void 0}))})),(n=function(){setInterval((()=>{a&&g(a).then((e=>{figma.ui.postMessage(Object.assign(Object.assign({},e),{selectedIconThumbnail:p,canvasColor:f()}))}))}),600)},r=2e3,function(){var e=this,i=arguments,t=function(){d=null,c||n.apply(e,i)},a=c&&!d;clearTimeout(d),d=setTimeout(t,r),a&&n.apply(e,i)})()}))})).catch((()=>{})),figma.ui.onmessage=e=>{"set-preview"===e.type&&(p=void 0,(o=void 0)?a=o:(console.log(a),a=figma.currentPage.selection[0]),u(o).then((e=>{g(a).then((i=>{figma.ui.postMessage(Object.assign(Object.assign({},i),{selectedIconThumbnail:e}))}))}))),"resize"===e.type&&(figma.ui.resize(e.size.width,e.size.height),figma.clientStorage.setAsync("uiSize",e.size).catch((e=>{}))),"scroll-position"===e.type&&figma.clientStorage.setAsync("scrollPos",e.pos).catch((e=>{}))};
